# CNN-based SFANC implemented in ANC Window

This repository contains the code for the paper "**Real-time Implementation and Explainable AI Analysis of Delayless CNN-based Selective Fixed-filter Active Noise Control**," accepted by the 'Mechanical Systems and Signal Processing' journal. The paper is available on [ResearchGate](https://www.researchgate.net/publication/379371184_Real-time_implementation_and_explainable_AI_analysis_of_delayless_CNN-based_selective_fixed-filter_active_noise_control) and [Elsevier](https://www.sciencedirect.com/science/article/pii/S0888327024002620).

<p align="center">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/de1f3812-74ac-4461-85b2-707b56064f07" height="300">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/81b6b1db-a9e4-4e2d-afe0-6ed24d708182" height="400">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/b2973645-06ec-405f-835b-ac17268f3873" height="300">
</p>

## Video of Experiment Results:
- [Active Noise Control Window based on SFANC](https://youtu.be/K1pWeNLMoDM)

## Highlights
1. The CNN-based selective fixed-filter active noise control (SFANC) method is implemented in a multichannel ANC window, which can achieve delayless noise reduction through the efficient coordination between the co-processor and real-time controller.

2. Combining practical experience, this paper abstracts ANC as a Markov progress and provides a detailed theoretical analysis to verify the reasonableness of the CNN-based SFANC method.

3. An explainable AI technique, LayerCAM, is used to provide visual explanations of the decision-making process in the CNN-based SFANC method.

4. Simulations and real-time experiments show that the CNN-based SFANC method not only effectively attenuates different types of low-frequency noise but also exhibits good transferability.

## Usage
1. **Pre-trained CNN**: A synthetic noise dataset is used to train the CNN, which contains 80,000 noise instances for training. The synthetic noise instances are generated by filtering white noise through various bandpass filters with randomly chosen center frequencies and bandwidths. Each noise instance has a 1-second duration. The code and pre-trained model of the CNN are provided in 'Modified_ShufflenetV2.py' and 'ShuffleNetV2_Synthetic.pth', respectively.
2. **Real-time Implementation**: 7 pre-trained control filters are obtained in the 4-channel ANC window with a 1 reference microphone, 4 secondary sources, and 4 error sensors. 7 broadband noises with different frequency ranges (as shown in the following fingure) are used as the primary noises to obtain the corresponding 7 pre-trained control filters.

<p align="center">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/82d0625b-3335-408e-abd1-492fcf88583e" height="50">
</p>

3. **Applying to New Environments**: We have provided the sub control filters on synthetic acoustic paths and our measured acoustic paths. If you want to use the Unsupervised-GFANC method on new acoustic paths, just obtain the corresponding pre-trained broadband control filter and decompose it into sub control filters. The trained 1D CNN in Unsupervised-GFANC can remain unchanged. For more details, please refer to the paper.

## Related Works
- [Delayless Generative Fixed-filter Active Noise Control based on Deep Learning and Bayesian Filter](https://ieeexplore.ieee.org/document/10339836/)
- [Deep Generative Fixed-Filter Active Noise Control](https://arxiv.org/pdf/2303.05788)
- [GFANC-Kalman: Generative Fixed-Filter Active Noise Control with CNN-Kalman Filtering](https://ieeexplore.ieee.org/document/10323505)
- [Unsupervised-GFANC: Unsupervised Learning Based End-to-End Delayless Generative Fixed-Filter Active Noise Control](https://arxiv.org/pdf/2402.09460.pdf)
- [A hybrid sfanc-fxnlms algorithm for active noise control based on deep learning](https://arxiv.org/pdf/2208.08082)
- [Performance Evaluation of Selective Fixed-filter Active Noise Control based on Different Convolutional Neural Networks](https://arxiv.org/pdf/2208.08440)
